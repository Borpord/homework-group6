# Project3: implement length extension attack for SM3, SHA256, etc.

## 长度扩展攻击原理：

长度扩展攻击是基于MD结构构建的，可由一个已知的哈希值而不需要知道其原像具体内容，便构造出另外一个哈希值。而基于MD结构的SM3算法并没有提到如何抵抗此种攻击，所以本项目对SM3算法开展了长度扩展攻击。

<img src=".\md_image\1.png" alt="image-20230703174051013" style="zoom: 100%;" />

具体流程如下：

1、得到某条未知消息M=M1||padding的哈希值H(M)。

2、用该哈希值H(M)作为初始IV向量，与攻击者自选消息M'共同输入到哈希函数中，得到附加消息之后的哈希值H'。

3、此时，该未知消息填充之后的内容与攻击者自选消息级联所得到的哈希值H(M||M')便与此条新哈希值H'相同，成功实现了碰撞。



## 项目结果：

采用SM3杂凑算法，所实现的SM3代码主要来自于Project 4，上述流程所述的未知消息设为字符串”Hello World!“，而附加消息选定为字符串”202100460055“。

运行结果如下图所示：

<img src=".\md_image\2.png" alt="image-20230703174051013" style="zoom: 100%;" />

可以看出，经过长度扩展攻击所构造出来的哈希值，与填充之后的原消息级联之后所得的哈希值相同。要想抵抗长度扩展攻击攻击，可对基于MD结构的算法进行改造，将其输出截断或对算法的首轮/末轮进行单独的特殊处理，这种处理策略虽然会增大硬件面积或软件代码规模，但可以对该攻击实现良好的抵抗。
