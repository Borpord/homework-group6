# Project3: implement length extension attack for SM3, SHA256, etc.

## 长度扩展攻击原理：

长度扩展攻击是基于MD结构构建的，可由一个已知的哈希值而不需要知道其原像内容，便构造出另外一个哈希值。

![image-20230708151557732](.\md_image\1.png)

具体流程如下：

1、得到某条未知消息的哈希值。

2、用该哈希值作为初始IV向量，与攻击者自选消息共同输入到哈希函数中，得到附加消息之后的哈希值。

3、此时，该未知消息填充之后的内容与攻击者自选消息级联所得到的哈希值便与此条新哈希值相同，成功实现了碰撞。



## 项目结果：

采用SM3杂凑算法，所实现的SM3代码主要来自于Project 4，上述流程所述的未知消息设为字符串”Hello World!“，而附加消息选定为字符串”202100460055“。

运行结果如下图所示：

![image-20230708152928190](.\md_image\2.png)

可以看出，经过长度扩展攻击所构造出来哈希值，与填充之后的原消息级联之后所构造出来的哈希值相同。
